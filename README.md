# RTL代码生成器

基于Excel表格自动生成RTL代码的工具，支持用户自定义代码保护。

## 🚀 快速开始

### 运行主脚本

```bash
python3 run_rtl_generator_main.py
```

这个主脚本会：
- 🔍 自动查找最新的 `Protocol_Arbiter*.xlsx` 文件
- 📝 基于表格内容生成RTL代码
- 🛡️ 保护现有的用户自定义代码块
- ✅ 进行代码风格检查和语法验证
- 📁 将生成的文件保存到 `./rtl/` 目录

## 📋 功能特性

### 🛡️ 用户自定义代码保护

系统会自动保护以下标记之间的用户自定义代码：

```verilog
//;// User Define Begin
// 您的自定义代码
//;// User Define End
```

或者：

```verilog
//==============================================================================
// User Define Begin
// 您的自定义代码
// User Define End  
//==============================================================================
```

### ✅ 自动检查

- **代码风格检查**: 自动修正常见的编码风格问题
- **语法检查**: 使用iverilog进行语法验证
- **警告处理**: 智能区分警告和错误，不会因为位宽警告而中断流程

## 📁 文件结构

```
TRAE_RTL/
├── run_rtl_generator_main.py     # 主运行脚本
├── generate_rtl_from_excel.py     # RTL生成器核心代码
├── Protocol_Arbiter*.xlsx         # Excel配置文件
├── rtl/                          # 生成的RTL文件目录
│   ├── protocol_arbiter.v
│   ├── command_arbiter.v
│   ├── function_arbiter.v
│   ├── bp_if.v
│   └── pre_all.v
└── README.md                     # 本文件
```

## 🔧 使用说明

### 1. 准备Excel文件

确保当前目录包含 `Protocol_Arbiter*.xlsx` 文件，系统会自动选择最新的文件。

### 2. 运行生成器

```bash
python3 run_rtl_generator_main.py
```

### 3. 查看结果

生成的RTL文件将保存在 `./rtl/` 目录中。

## ⚠️ 注意事项

1. **用户自定义代码**: 请将您的自定义逻辑放在指定的标记块内，以确保在重新生成时不会丢失。

2. **位宽警告**: 系统可能会显示一些位宽不匹配的警告，这些通常不影响功能，系统会自动进行位宽填充。

3. **备份**: 建议在大幅修改前备份您的用户自定义代码。

## 🐛 故障排除

### Excel文件未找到
```
❌ 错误: 未找到 Protocol_Arbiter*.xlsx 文件
💡 请确保当前目录包含 Protocol_Arbiter*.xlsx 文件
```

**解决方案**: 确保Excel文件在当前目录且文件名以 `Protocol_Arbiter` 开头。

### 语法检查失败
```
❌ 语法检查: 失败
```

**解决方案**: 检查生成的RTL代码是否有语法错误，特别是用户自定义代码块。

## 📞 支持

如果遇到问题，请检查：
1. Excel文件格式是否正确
2. 用户自定义代码语法是否正确
3. 是否有足够的文件权限

---

**版本**: 2024.12
**更新**: 支持新的用户自定义代码标记格式和智能语法检查